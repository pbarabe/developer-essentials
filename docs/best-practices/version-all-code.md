# Best Practice: Version All Code

## Description

Version control refers to the tracking of every change to code under our control.
We use Git for version control.
Our best practice is to put all code that we write or generate under version control, though different categories of code should be approached differently:

* "In-house" code: if we've written an application or script from scratch or using a framework, it **must** be under version control. Small dependencies (e.g., jQuery) may also be in the code repository, but it's preferable to use those via Content Delivery Network (CDN) URLs whenever possible.
* Generated code: if we have code that is generated by a tool (e.g., the Drupal Features module or the CakePHP bake command), it **must** be under version control.
* Third-party code: code, frameworks, libraries, or applications (proprietary or open-source) supplied by third parties **must not** be under version control, except in the case of forking.
* Extensions to third-party code: Templates, extensions, or customizations that we create for third-party systems **must** be under version control. It is acceptable to put small dependencies under version control.

## Specific Standards

* Use [Semantic Versioning](https://semver.org/) for all release tags.
* Use the [Forking Workflow](https://www.atlassian.com/git/tutorials/comparing-workflows/forking-workflow) for most work. Any development work more significant than a tiny bug fix (eg. fixing a typo) should be done in a branch and merged into master when complete.
* Deploy to production from tags. Use [annotated tags](https://git-scm.com/book/en/v2/Git-Basics-Tagging#Annotated-Tags) when deploying with git.
* Never delete deployment tags after they've been pushed to the remote.
* Write [useful commit messages](https://chris.beams.io/posts/git-commit/). Reference issues as much as possible. It is strongly encouraged to create issues for all but the most trivial things.
* In production/staging/shared dev environments, the git status should come back clean, i.e., empty. Use ignore rules to accomplish this.
* Merge only stable code into master. Feature branches and Works-In-Progress (WIPs) should never be merged into master until they are complete and believed to be free of flaws.
* **NEVER** commit sensitive information like passwords.
* Don't commit user-generated content.
* Don’t commit logs or system-generated files.
* Commits must be "[atomic](https://www.freshconsulting.com/atomic-commits/)". That is, each logical change should be a separate commit.
* As an example of atomic commits, whitespace and coding standards changes must be in their own commits.
* Err on the side of committing and pushing to the centrally-hosted repository more often (at least once a day).

## Rationale

Version control is a foundation of modern development teams. It benefits a team by boosting developer confidence, improving collaboration, and increasing transparency. It protects against developer mistakes, and it serves as a rudimentary deployment tool. Integration with an issue tracking system increases the value.

## Exceptions

* Drupal 7.x Modules, Features, and Themes: Drupal up to version 7.x uses it's own version tag rubric. Eg. A module's release version might be something like `7.x-1.3` (rather than `1.3.0`).
* Drupal Features: This is generated code. We will not follow the tagging procedure here. This standard must be followed in all other respects.
* Things deployed on a local file system with no access to version control don’t need a tag.
